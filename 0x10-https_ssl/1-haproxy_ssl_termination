frontend www-https
    bind *:443 ssl crt /etc/haproxy/ssl/cert.pem
    mode http
    option forwardfor
    reqadd X-Forwarded-Proto:\ https
    default_backend www-backend

backend www-backend
    mode http
    option forwardfor
    http-request set-header X-Forwarded-Port %[dst_port]
    http-request add-header X-Forwarded-Proto https if { ssl_fc }
    server 116739-web-01 54.236.17.124:80 check
    server 116739-web-02 100.24.237.123:80 check

frontend http-in
    bind *:80
    reqadd X-Forwarded-Proto:\ http
    default_backend www-backend
